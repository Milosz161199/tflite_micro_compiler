
$(foreach setting, $(shell ../GET_PROJECT_SETTINGS.sh --makefile --id_prefix IFX_), $(eval $(setting)))
INSTALLED_TFLITE_MICRO=$(IFX_TOOLSPREFIX)/tflite_u-$(IFX_TFLITE_MICRO_VERSION)

include $(INSTALLED_TFLITE_MICRO)/tools/make/Makefile

HOST_MAKE = $(MAKE) TARGET=$(HOST_OS) TARGET_ARCH=x86_64 BUILD_TYPE=

EXAMPLE_TYPE ?= generated
COMPILER_EXE := $(GENDIR)bin/compiler
EXAMPLE_NETS:=hello_world cifar10 mobilenet
EXAMPLES:=$(foreach e, $(EXAMPLE_NETS), $(e) $(e)_compiled )


.PHONY: examples run_examples regenerate regenerate_examples

regenerate:
	$(HOST_MAKE) compiler
	$(HOST_MAKE) regenerate_examples

examples:  $(EXAMPLES)

run_examples:  examples
	for f in $(EXAMPLES); do  $(GENDIR)bin/$${f}; done

regenerate_examples: 
	mkdir -p examples/generated/
	$(COMPILER_EXE) examples/hello_world.tflite examples/compiled_hello_world.cc hello_ 
	$(COMPILER_EXE) examples/mobilenet_v1_0_25_160_quantized.tflite examples/compiled_mobilenet.cc mobilenet_
	$(COMPILER_EXE) examples/cifar10.tflite examples/compiled_cifar10.cc cifar_
